basePath: /
definitions:
  chat.Dialog:
    properties:
      castingID:
        type: string
      createdAt:
        type: string
      id:
        type: string
      imageURL:
        type: string
      isGroup:
        type: boolean
      lastMessage:
        $ref: '#/definitions/chat.Message'
      lastMessageID:
        type: string
      participants:
        items:
          $ref: '#/definitions/chat.DialogParticipant'
        type: array
      title:
        type: string
      updatedAt:
        type: string
    type: object
  chat.DialogParticipant:
    properties:
      dialogID:
        type: string
      id:
        type: string
      isMuted:
        type: boolean
      joinedAt:
        type: string
      lastSeenAt:
        type: string
      leftAt:
        type: string
      role:
        description: member, admin, owner
        type: string
      typingUntil:
        type: string
      userID:
        type: string
    type: object
  chat.Message:
    properties:
      attachmentName:
        type: string
      attachmentURL:
        type: string
      attachments:
        items:
          $ref: '#/definitions/chat.MessageAttachment'
        type: array
      content:
        type: string
      createdAt:
        type: string
      deletedAt:
        type: string
      dialogID:
        type: string
      forwardFrom:
        $ref: '#/definitions/chat.Message'
      forwardFromID:
        type: string
      id:
        type: string
      reactions:
        items:
          $ref: '#/definitions/chat.MessageReaction'
        type: array
      readReceipts:
        items:
          $ref: '#/definitions/chat.MessageReadReceipt'
        type: array
      replyTo:
        $ref: '#/definitions/chat.Message'
      replyToID:
        type: string
      senderID:
        type: string
      status:
        description: sent, delivered, read, deleted
        type: string
      type:
        description: text, image, video, file, system
        type: string
    type: object
  chat.MessageAttachment:
    properties:
      createdAt:
        type: string
      fileName:
        type: string
      fileType:
        description: image, video, file
        type: string
      id:
        type: string
      messageID:
        type: string
      mimeType:
        type: string
      size:
        type: integer
      uploaderID:
        type: string
      url:
        type: string
    type: object
  chat.MessageReaction:
    properties:
      createdAt:
        type: string
      emoji:
        type: string
      id:
        type: string
      messageID:
        type: string
      userID:
        type: string
    type: object
  chat.MessageReadReceipt:
    properties:
      id:
        type: string
      messageID:
        type: string
      readAt:
        type: string
      userID:
        type: string
    type: object
  dto.CreateDialogInput:
    description: Структура запроса для создания личного или группового чата creator_id
      должен быть одним из участников participant_ids - список user_id, включая creator
      is_group = true означает групповой чат, иначе личный title используется только
      для группового чата
    properties:
      creator_id:
        type: string
      is_group:
        type: boolean
      participant_ids:
        items:
          type: string
        type: array
      title:
        description: nullable — только для групп
        type: string
    required:
    - creator_id
    - participant_ids
    type: object
  dto.ModelAnalytics:
    properties:
      income:
        type: number
      rating:
        type: number
      responses:
        type: integer
      views:
        type: integer
    type: object
  dto.SendMessageInput:
    description: Используется при отправке сообщения, включая вложения и цитирование
    properties:
      attachment_ids:
        items:
          type: string
        type: array
      content:
        type: string
      dialog_id:
        type: string
      forward_from:
        type: string
      reply_to_id:
        type: string
      sender_id:
        type: string
    required:
    - dialog_id
    - sender_id
    type: object
  dto.SubscriptionPlanResponse:
    properties:
      currency:
        type: string
      duration:
        type: string
      features:
        additionalProperties: true
        type: object
      id:
        type: string
      limits:
        additionalProperties: true
        type: object
      name:
        type: string
      price:
        type: number
    type: object
  dto.UploadResponse:
    properties:
      id:
        example: abc123
        type: string
      mimeType:
        example: image/jpeg
        type: string
      size:
        example: 204800
        type: integer
      url:
        example: /uploads/models/abc.jpg
        type: string
      usage:
        example: avatar
        type: string
    type: object
  dto.UserSubscriptionResponse:
    properties:
      auto_renew:
        type: boolean
      end_date:
        type: string
      id:
        type: string
      plan_id:
        type: string
      start_date:
        type: string
      status:
        type: string
      usage:
        additionalProperties: true
        type: object
      user_id:
        type: string
    type: object
  handlers.LoginInput:
    properties:
      email:
        type: string
      password:
        type: string
    required:
    - email
    - password
    type: object
  handlers.RefreshInput:
    properties:
      refresh_token:
        type: string
    required:
    - refresh_token
    type: object
  handlers.RegisterInput:
    properties:
      email:
        type: string
      password:
        minLength: 6
        type: string
      role:
        type: string
    required:
    - email
    - password
    - role
    type: object
  handlers.SubscribeRequest:
    properties:
      auto_renew:
        type: boolean
      plan_id:
        type: string
      user_id:
        type: string
    type: object
  handlers.toggleReactionInput:
    properties:
      emoji:
        type: string
      message_id:
        type: string
      user_id:
        type: string
    required:
    - emoji
    - message_id
    - user_id
    type: object
  models.CastingResponse:
    properties:
      castingID:
        type: string
      createdAt:
        type: string
      id:
        type: string
      message:
        type: string
      modelID:
        type: string
      status:
        description: '"pending" | "accepted" | "rejected"'
        type: string
    type: object
  models.EmployerProfile:
    properties:
      city:
        type: string
      companyName:
        type: string
      companyType:
        type: string
      contactPerson:
        type: string
      createdAt:
        type: string
      description:
        type: string
      id:
        type: string
      isVerified:
        type: boolean
      phone:
        type: string
      updatedAt:
        type: string
      userID:
        type: string
      website:
        type: string
    type: object
  models.ErrorResponse:
    properties:
      error:
        example: invalid input
        type: string
    type: object
  models.ModelProfile:
    type: object
  models.User:
    properties:
      createdAt:
        type: string
      email:
        description: уникальный индекс
        type: string
      id:
        description: UUID primary key
        type: string
      isVerified:
        type: boolean
      passwordHash:
        type: string
      resetToken:
        type: string
      resetTokenExp:
        type: string
      role:
        description: model | employer | admin
        type: string
      status:
        description: pending | active | suspended | banned
        type: string
      subscription:
        description: free | premium | pro
        type: string
      updatedAt:
        type: string
      verificationToken:
        type: string
    type: object
host: localhost:4000
info:
  contact:
    email: support@company.com
    name: Модельное агенство
    url: http://contact.company.com
  description: API для управления модельной компанией (документация Swagger).
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: http://your-terms.com/terms/
  title: mwork API
  version: "1.0"
paths:
  /analytics/model:
    get:
      consumes:
      - application/json
      description: Возвращает статистику по просмотрам, рейтингу, доходу и откликам
        модели. UserID берётся из JWT.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.ModelAnalytics'
        "400":
          description: Некорректный userID
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "401":
          description: Неавторизован или отсутствует токен
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "404":
          description: Профиль модели не найден
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Ошибка при получении аналитики
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Получить аналитику модели
      tags:
      - analytics
  /auth/login:
    post:
      consumes:
      - application/json
      description: Возвращает access и refresh токены при успешной аутентификации
      parameters:
      - description: Email и пароль
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/handlers.LoginInput'
      produces:
      - application/json
      responses:
        "200":
          description: access_token, refresh_token, user
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Неверный формат ввода
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "401":
          description: Неверные учётные данные
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Вход пользователя
      tags:
      - auth
  /auth/logout:
    post:
      consumes:
      - application/json
      description: Удаляет refresh токен (разлогинивает пользователя)
      parameters:
      - description: Refresh токен для удаления
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/handlers.RefreshInput'
      produces:
      - application/json
      responses:
        "200":
          description: message
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Неверный формат ввода
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "401":
          description: Ошибка при удалении токена
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Выход из системы
      tags:
      - auth
  /auth/refresh:
    post:
      consumes:
      - application/json
      description: Получить новый access-токен по refresh-токену
      parameters:
      - description: Refresh токен
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/handlers.RefreshInput'
      produces:
      - application/json
      responses:
        "200":
          description: access_token
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Неверный формат ввода
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "401":
          description: Недействительный токен
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Обновление access-токена
      tags:
      - auth
  /auth/register:
    post:
      consumes:
      - application/json
      description: Регистрирует нового пользователя по email, паролю и роли
      parameters:
      - description: Данные регистрации
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/handlers.RegisterInput'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.User'
        "400":
          description: Неверный формат ввода или ошибка регистрации
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Регистрация нового пользователя
      tags:
      - auth
  /chat/dialogs:
    post:
      consumes:
      - application/json
      parameters:
      - description: Информация о диалоге
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/dto.CreateDialogInput'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/chat.Dialog'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Создать новый диалог (личный или групповой)
      tags:
      - Chat
  /chat/dialogs/{id}/files:
    get:
      parameters:
      - description: ID диалога
        in: path
        name: id
        required: true
        type: string
      - description: Фильтр по типу (image, video, file)
        in: query
        name: type
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/chat.MessageAttachment'
            type: array
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Получить вложения в диалоге
      tags:
      - Chat
  /chat/dialogs/{id}/leave:
    post:
      parameters:
      - description: ID диалога
        in: path
        name: id
        required: true
        type: string
      - description: ID пользователя
        in: query
        name: user_id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Выйти из диалога
      tags:
      - Chat
  /chat/dialogs/{id}/messages:
    get:
      parameters:
      - description: ID диалога
        in: path
        name: id
        required: true
        type: string
      - description: ID пользователя
        in: query
        name: user_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/chat.Message'
            type: array
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Получить сообщения из диалога
      tags:
      - Chat
  /chat/dialogs/{id}/read:
    post:
      parameters:
      - description: ID диалога
        in: path
        name: id
        required: true
        type: string
      - description: ID пользователя
        in: query
        name: user_id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Отметить все сообщения как прочитанные
      tags:
      - Chat
  /chat/dialogs/{id}/unread:
    get:
      parameters:
      - description: ID диалога
        in: path
        name: id
        required: true
        type: string
      - description: ID пользователя
        in: query
        name: user_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: integer
            type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Получить количество непрочитанных сообщений в диалоге
      tags:
      - Chat
  /chat/messages/send:
    post:
      consumes:
      - application/json
      parameters:
      - description: Тело сообщения
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/dto.SendMessageInput'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/chat.Message'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Отправить сообщение в диалог
      tags:
      - Chat
  /chat/reactions/toggle:
    post:
      consumes:
      - application/json
      parameters:
      - description: Реакция
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/handlers.toggleReactionInput'
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Поставить или убрать реакцию на сообщение
      tags:
      - Chat
  /employer-profiles:
    post:
      consumes:
      - application/json
      description: Создаёт новый профиль работодателя на основе переданных данных
      parameters:
      - description: Данные профиля работодателя
        in: body
        name: profile
        required: true
        schema:
          $ref: '#/definitions/models.EmployerProfile'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.EmployerProfile'
        "400":
          description: Некорректный JSON
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Ошибка при создании профиля
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Создать профиль работодателя
      tags:
      - employer-profiles
  /employer-profiles/{user_id}:
    get:
      consumes:
      - application/json
      description: Возвращает профиль работодателя, связанный с указанным user_id
      parameters:
      - description: ID пользователя
        in: path
        name: user_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.EmployerProfile'
        "404":
          description: Профиль не найден
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Получить профиль работодателя по ID пользователя
      tags:
      - employer-profiles
  /model-profiles:
    post:
      consumes:
      - application/json
      description: Создаёт новый профиль модели на основе переданных данных
      parameters:
      - description: Данные модельного профиля
        in: body
        name: profile
        required: true
        schema:
          $ref: '#/definitions/models.ModelProfile'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.ModelProfile'
        "400":
          description: Некорректный JSON
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Ошибка сервера при создании профиля
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Создать модельный профиль
      tags:
      - model-profiles
  /model-profiles/{user_id}:
    get:
      consumes:
      - application/json
      description: Возвращает профиль модели, связанный с указанным user_id
      parameters:
      - description: ID пользователя
        in: path
        name: user_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.ModelProfile'
        "404":
          description: Профиль не найден
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Получить профиль модели по ID пользователя
      tags:
      - model-profiles
  /responses:
    get:
      consumes:
      - application/json
      description: Возвращает список откликов по ID кастинга
      parameters:
      - description: ID кастинга
        in: query
        name: casting_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.CastingResponse'
            type: array
        "500":
          description: Ошибка при получении откликов
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Получить отклики на кастинг
      tags:
      - responses
    post:
      consumes:
      - application/json
      description: Создаёт отклик на кастинг со статусом "pending"
      parameters:
      - description: Отклик на кастинг
        in: body
        name: response
        required: true
        schema:
          $ref: '#/definitions/models.CastingResponse'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.CastingResponse'
        "400":
          description: Некорректный JSON
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Ошибка при создании отклика
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Отклик на кастинг
      tags:
      - responses
  /responses/{id}:
    get:
      consumes:
      - application/json
      description: Возвращает отклик по ID
      parameters:
      - description: ID отклика
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.CastingResponse'
        "404":
          description: Отклик не найден
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Получить отклик по ID
      tags:
      - responses
  /subscriptions:
    post:
      consumes:
      - application/json
      description: Создаёт новую подписку на основе переданных данных
      parameters:
      - description: Данные подписки
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.SubscribeRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/dto.UserSubscriptionResponse'
        "400":
          description: Некорректный ввод
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Ошибка при создании подписки
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Оформить подписку
      tags:
      - subscriptions
  /subscriptions/plans:
    get:
      consumes:
      - application/json
      description: Возвращает все доступные планы подписки
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/dto.SubscriptionPlanResponse'
            type: array
        "500":
          description: Ошибка при получении планов
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Получить список подписочных планов
      tags:
      - subscriptions
  /subscriptions/usage-limit:
    get:
      consumes:
      - application/json
      description: Проверяет, можно ли выполнить указанное действие в рамках текущей
        подписки
      parameters:
      - description: ID пользователя
        in: query
        name: user_id
        required: true
        type: string
      - description: 'Тип действия (например: upload, apply)'
        in: query
        name: action
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 'allowed: bool, remaining: int'
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Отсутствует user_id или action
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Ошибка при проверке лимита
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Проверить лимит использования
      tags:
      - subscriptions
  /subscriptions/user/{userID}:
    get:
      consumes:
      - application/json
      description: Возвращает текущую активную подписку по ID пользователя
      parameters:
      - description: ID пользователя
        in: path
        name: userID
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.UserSubscriptionResponse'
        "400":
          description: userID не указан
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "404":
          description: Подписка не найдена
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Получить активную подписку пользователя
      tags:
      - subscriptions
  /upload:
    post:
      consumes:
      - multipart/form-data
      description: Загружает файл и сохраняет его с привязкой к сущности (entityType,
        entityId, usage). Требуется авторизация.
      parameters:
      - description: Файл для загрузки
        in: formData
        name: file
        required: true
        type: file
      - description: Тип сущности (например, 'model_profile', 'casting')
        in: formData
        name: entityType
        required: true
        type: string
      - description: ID сущности
        in: formData
        name: entityId
        required: true
        type: string
      - description: Назначение файла (например, 'avatar', 'portfolio')
        in: formData
        name: usage
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.UploadResponse'
        "400":
          description: Некорректный ввод
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "401":
          description: Неавторизован
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Ошибка сервера
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Загрузить файл
      tags:
      - upload
  /users/{id}:
    delete:
      consumes:
      - application/json
      description: Удаляет пользователя по его ID
      parameters:
      - description: ID пользователя
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: failed to delete user
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Удалить пользователя
      tags:
      - users
    get:
      consumes:
      - application/json
      description: Возвращает пользователя по его ID
      parameters:
      - description: ID пользователя
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.User'
        "400":
          description: user not found
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Получить пользователя по ID
      tags:
      - users
    put:
      consumes:
      - application/json
      description: Обновляет поля пользователя по его ID (например, статус)
      parameters:
      - description: ID пользователя
        in: path
        name: id
        required: true
        type: string
      - description: Данные для обновления
        in: body
        name: update
        required: true
        schema:
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.User'
        "400":
          description: failed to update user
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Обновить пользователя
      tags:
      - users
swagger: "2.0"
